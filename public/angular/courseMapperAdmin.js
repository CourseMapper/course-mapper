var admin=angular.module("courseMapperAdmin",["ngResource","ngRoute"]);admin.filter("capitalize",function(){return function(a,b){return a?a.replace(/([^\W_]+[^\s-]*) */g,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()}):""}}),admin.controller("applicationsController",["$scope","$route","$routeParams","$location","$http",function(a,b,c,d,e){function f(a,b){for(var c in b){var d=b[c];d.name==a.name&&(d.isActive=a.isActive)}}a.route=b,a.location=d,a.routeParams=c,a.widgets=null,a.init=function(){e.get("/api/widgets/all").success(function(b){b.result&&b.widgets&&(a.widgets=b.widgets)})},a.activate=function(b,c){e.put("/api/widgets/"+b+"/"+c,{isActive:!0}).success(function(b){b.result&&b.widget&&f(b.widget,a.widgets)})},a.deactivate=function(b,c){e.put("/api/widgets/"+b+"/"+c,{isActive:!1}).success(function(b){b.result&&b.widget&&f(b.widget,a.widgets)})},a.init()}]),admin.controller("CategoryListController",["$scope","$http","$rootScope",function(a,b,c){a.initData=function(){b.get("/api/categories").success(function(b){a.categories=b.categories})},a.initData(),a.$on("sidebarInit",function(a){$.AdminLTE.tree(".sidebar")}),a.$on("init",function(b,c){a.initData()})}]),admin.controller("categoryFormController",["$scope","$http",function(a,b){a.formData=[],a.processForm=function(c){var d=transformRequest(a.formData[c]);b({method:"POST",url:"/api/categories",data:d,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){console.log(b),b.result&&(a.newCategory=b.category,a.$emit("init"))}).error(function(b){b.result||(a.errorName=b.errors.name,console.log(b.errors))})}}]),admin.controller("tagFormController",["$scope","$http",function(a,b){a.formData={},a.setCategory=function(b){a.formData.category=b},a.processForm=function(){var c=transformRequest(a.formData);b({method:"POST",url:"/api/courseTags",data:c,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){console.log(b),b.result&&(a.newTag=b.tag,a.$emit("init"))}).error(function(b){b.result||(a.errorName=b.errors.name,console.log(b.errors))})}}]),admin.controller("courseFormController",["$scope","$http",function(a,b){a.formData={},a.setCategory=function(b){a.formData.category=b},a.processForm=function(){var c=transformRequest(a.formData);b({method:"POST",url:"/api/courses",data:c,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){console.log(b),b.result&&(a.newCourse=b.course,a.$emit("init"))}).error(function(b){b.result||(a.errorName=b.errors.name,console.log(b.errors))})}}]),admin.controller("CourseListController",["$scope","$http","$rootScope",function(a,b,c){b.get("/api/courses").success(function(b){a.courses=b.courses})}]),admin.controller("categoryDetailController",["$scope","$http","$routeParams",function(a,b,c){a.category="",a.courses={},a.courseTags={},b.get("/api/category/"+c.category).success(function(b){b.category&&(a.category=b.category,a.courseTags=b.category.courseTags)}),a.getCourses=function(){b.get("/api/category/"+a.category._id+"/courses").success(function(b){a.courses=b.courses})},a.getCourseTags=function(){b.get("/api/category/"+a.category._id+"/courseTags").success(function(b){a.tags=b.courseTags})},a.$watch("category",function(b,c){a.category&&(a.getCourses(),a.getCourseTags())}),a.initData=function(){a.getCourses(),a.getCourseTags()},a.$on("init",function(b,c){a.initData()})}]),admin.controller("adminController",["$scope","$route","$routeParams","$location",function(a,b,c,d){a.$route=b,a.$location=d,a.$routeParams=c}]),admin.controller("MainMenuController",["$scope","$http","$rootScope",function(a,b,c){b.get("/api/accounts").success(function(b){a.user=b,c.user=b})}]),admin.config(["$routeProvider",function(a){a.when("/categories",{templateUrl:"/cm-admin/categories",controller:"adminController",resolve:{pd:["$q",function(a){return{title:"Manage Categories",breads:[{a:"",active:!0,title:"Categories"}]}}]}}).when("/categories/:category",{templateUrl:"/cm-admin/category",controller:"adminController",resolve:{pd:["$q",function(a){return{title:"Manage Category",breads:[{a:"#/categories",active:!1,title:"Categories"}]}}]}}).when("/widgets",{templateUrl:"/cm-admin/applications",controller:"applicationsController",resolve:{pd:["$q",function(a){return{title:"Manage Widgets",breads:[{a:"#/widgets",active:!1,title:"Widgets"}]}}]}}).otherwise({redirectTo:"/cm-admin"})}]);