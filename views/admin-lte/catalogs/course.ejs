<% include ../header %>
<div class="wrapper">

    <!-- Header Navbar -->
    <% include ../mainMenu %>

    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper" ng-view>
    </div>
    <!-- /.content-wrapper -->


    <script type="text/ng-template" id="course_detail.html">
        <section class="content-header">
            <ol class="breadcrumb">
                <li><a href="/"><i class="fa fa-home"></i> Home</a></li>
                <li><a href="/courses/#/category/<%=course.category.slug%>"> </i> <%=course.category.name%></a></li>
                <li class="active"><%=course.name%></li>
            </ol>
        </section>
        <section class="content-header action-header blue">
            <ol class="breadcrumb">
                <li class="home"><%=course.name%></li>
                <li class="active">Preview</li>
            </ol>

            <div class="navbar-custom-menu">
                <ul class="">
                    <li>
                        <a ng-hide="user" class="" href="/accounts/login?ref={{followUrl|base64Encode:true}}">Please
                            login to enroll to this course</a>

                        <i ng-show="loading" class="fa fa-refresh fa-spin"></i>
                        <a ng-show="user && !enrolled" ng-click="enroll()" href=""><strong>Enroll here to participate in this course</strong></a>

                        <span ng-show="enrolled">You are following this course.</span>
                        <a ng-show="enrolled" class="" href="/api/course/<%= course._id%>/leave">
                            click here to Unenroll</a>

                    </li>
                </ul>
                {{loc}}
            </div>
        </section>

        <!-- Main content -->
        <section class="content-course">
            <div class="box no-border" id="courseTabs">
                <!--<div class="box-header no-border">
                    <h1><span class="hidden-xs course"></span><span class="visible-xs" style="margin-left:15px"></span><%=course.name%>
                    </h1>
                </div>-->
                <div class="box-body no-border">

                    <!-- tabs left -->
                    <div class="tabbable tabs-left">
                        <ul class="nav nav-tabs tabs-hide hidden-xs">
                            <li class="active"><a href="#/preview" data-toggle="tab" data-target="#preview">
                                <i class="ionicons ion-ios-home-outline"></i><br>
                                <span>Preview</span></a></li>

                            <li ng-show="enrolled"><a href="#/map" data-toggle="tab" data-target="#map">
                                <i class="ionicons ion-map"></i>
                                <span>CourseMap</span></a></li>
                            <li ng-show="enrolled"><a href="#/updates" ng-show="user" data-toggle="tab" data-target="#updates">
                                <i class="ionicons ion-ios-time-outline"></i><br>
                                <span>Updates</span></a></li>
                            <li ng-show="enrolled"><a href="#/discussion" ng-show="user" data-toggle="tab" data-target="#discussion">
                                <i class="ionicons ionicons ion-ios-chatboxes-outline"></i><br>
                                <span>Discussion</span></a></li>
                            <li ng-show="enrolled"><a href="#/analytics" ng-show="user" data-toggle="tab" data-target="#analytics">
                                <i class="ionicons ion-stats-bars"></i><br>
                                <span>Analytics</span></a></li>
                        </ul>
                        <div class="tab-content">
                            <div class="tab-pane active" id="preview">

                                <div class="col-xs-9">
                                    <img class="preview-image" src="/img/courses/<%=(course.picture)?course.picture:'placeholder.png'%>">
                                    <div class="container">
                                        <div class="excerpt">
                                            <div class="description">
                                                Started By:
                                                <strong>
                                                    <%=course.createdBy.username%>
                                                </strong> on <b>
                                                <%=moment(course.dateAdded).fromNow()%></b>

                                                <h1>
                                                    <span class="visible-xs" style="margin-left:15px"></span><%=course.name%>
                                                </h1>
                                                <%=course.description%>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane" id="map">
                                <div class="box-body no-border" id="tree" ng-controller="TreeController">
                                    <cm-tree el="treeSVG" width="4000" height="4000">
                                        <% include rightMenu %>
                                    </cm-tree>
                                </div>
                            </div>
                            <div class="tab-pane" id="discussion"></div>
                            <div class="tab-pane" id="updates"></div>
                            <div class="tab-pane" id="analytics"></div>
                        </div>
                    </div>
                    <!-- /tabs -->

                </div>
            </div>


        </section>
        <!-- /.content -->
    </script>

</div><!-- ./wrapper -->

<% include ../jsfooter %>
<script src="/d3/rightclick.js"></script>
<script src="/d3/tree.js"></script>

<% include ../footer %>