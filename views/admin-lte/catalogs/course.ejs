<% include ../header %>
<div class="wrapper">

    <!-- Header Navbar -->
    <% include ../mainMenu %>

    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper" ng-view>
    </div>
    <!-- /.content-wrapper -->


    <script type="text/ng-template" id="course_detail.html">
        <section class="content-header">
            <ol class="breadcrumb">
                <li><a href="/"><i class="fa fa-home"></i> Home</a></li>
                <li><a href="/courses/#/category/<%=course.category.slug%>"> </i> <%=course.category.name%></a></li>
                <li class="active"><%=course.name%></li>
            </ol>
        </section>
        <section class="content-header action-header blue">
            <ol class="breadcrumb">
                <li class="home"><%=course.name%></li>
                <li class="active">Preview</li>
            </ol>

            <div class="navbar-custom-menu">
                <ul class="">
                    <li ng-hide="isOwner">
                        <a ng-hide="user" class="" href="/accounts/login?ref={{followUrl|base64Encode:true}}">Please
                            login to enroll to this course</a>

                        <i ng-show="loading" class="fa fa-refresh fa-spin"></i>
                        <a ng-show="user && !enrolled" ng-click="enroll()" style="cursor: pointer"><strong>Enroll here to participate in this course</strong></a>

                        <span ng-show="enrolled && !loading">You are following this course.</span>
                        <a ng-show="enrolled" class="" style="cursor:pointer" ng-click="leave()">
                            LEAVE COURSE</a>

                    </li>
                    <li ng-show="isOwner">
                        You created this course
                    </li>
                    <li ng-show="isOwner">
                        <a ng-click="editMode()" style="cursor: pointer"><i class="ionicons ion-edit"></i> &nbsp; EDIT</a>
                    </li>
                    <li ng-show="isOwner">
                        <a data-toggle="modal" style="cursor: pointer;"
                           data-target="#modalAppGallery" title="Add or remove dashboard widgets">
                            <i class="ionicons ion-android-apps"></i> &nbsp; WIDGETS STORE</a>
                    </li>
                </ul>
            </div>
        </section>

        <!-- Main content -->
        <section class="content-course">
            <div class="box no-border" id="courseTabs">
                <div class="box-body no-border">

                    <!-- tabs left -->
                    <div class="tabbable tabs-left">
                        <ul class="nav nav-tabs tabs-hide hidden-xs">
                            <li class="active"><a href="#/preview" data-toggle="tab" data-target="#preview">
                                <i class="ionicons ion-ios-home-outline"></i><br>
                                <span>Preview</span></a></li>

                            <li ng-show="enrolled"><a href="#/map" data-toggle="tab" data-target="#map">
                                <i class="ionicons ion-map"></i>
                                <span>CourseMap</span></a></li>
                            <li ng-show="enrolled"><a href="#/updates" ng-show="user" data-toggle="tab" data-target="#updates">
                                <i class="ionicons ion-ios-time-outline"></i><br>
                                <span>Updates</span></a></li>
                            <li ng-show="enrolled"><a href="#/discussion" ng-show="user" data-toggle="tab" data-target="#discussion">
                                <i class="ionicons ionicons ion-ios-chatboxes-outline"></i><br>
                                <span>Discussion</span></a></li>
                            <li ng-show="enrolled"><a href="#/analytics" ng-show="user" data-toggle="tab" data-target="#analytics">
                                <i class="ionicons ion-stats-bars"></i><br>
                                <span>Analytics</span></a></li>
                        </ul>
                        <div class="tab-content">
                            <div class="tab-pane active" id="preview">

                                <div class="col-xs-9">
                                    <img class="preview-image" src="/img/courses/<%=(course.picture)?course.picture:'placeholder.png'%>">
                                    <div class="container">
                                        <div class="excerpt">
                                            <div class="description">
                                                Started By:
                                                <strong>
                                                    {{user.username}}
                                                </strong> on <b>
                                                <%=moment(course.dateAdded).fromNow()%></b>

                                                <h1>
                                                    <span class="visible-xs" style="margin-left:15px"></span><%=course.name%>
                                                </h1>
                                                <%=course.description%>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane" id="map">
                                <div class="box-body no-border" id="tree">
                                    <cm-tree el="treeSVG" width="4000" height="4000">
                                        <% include rightMenu %>
                                    </cm-tree>
                                </div>
                            </div>
                            <div class="tab-pane" id="discussion"></div>
                            <div class="tab-pane" id="updates"></div>
                            <div class="tab-pane" id="analytics"></div>
                        </div>
                    </div>
                    <!-- /tabs -->

                </div>
            </div>


        </section>
        <!-- /.content -->
    </script>

</div><!-- ./wrapper -->

<div class="row">
    <div class="modal" id="modalAppGallery" tabindex="-1" role="dialog"
         aria-labelledby="modalAppGallery" aria-hidden="true">
        <div ng-include="'/apps/gallery/course-preview'"></div>
    </div>
</div>

<% include ../jsfooter %>
<script src="/d3/rightclick.js"></script>
<script src="/d3/tree.js"></script>

<% include ../footer %>